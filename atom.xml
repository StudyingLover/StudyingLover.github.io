<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>plus studio</title>
  
  
  <link href="https://studyinglover.github.io/atom.xml" rel="self"/>
  
  <link href="https://studyinglover.github.io/"/>
  <updated>2023-02-07T09:07:55.221Z</updated>
  <id>https://studyinglover.github.io/</id>
  
  <author>
    <name>StudyingLover</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>yolov5和yolov5-face常见踩坑</title>
    <link href="https://studyinglover.github.io/2023/02/07/yolov5%E5%B8%B8%E8%A7%81%E8%B8%A9%E5%9D%91/"/>
    <id>https://studyinglover.github.io/2023/02/07/yolov5%E5%B8%B8%E8%A7%81%E8%B8%A9%E5%9D%91/</id>
    <published>2023-02-07T16:49:00.000Z</published>
    <updated>2023-02-07T09:07:55.221Z</updated>
    
    <content type="html"><![CDATA[<h1 id="yolov5常见踩坑">yolov5常见踩坑</h1><h2 id="not-enough-values-to-unpack-expected-2-got-0">not enough values to unpack (expected 2, got 0)</h2><p>如图 <img src="https://cdn.jsdelivr.net/gh/StudyingLover/anything/93bbd4d663cd589dfdd522e0479bb46.png" /></p><p>我们需要检查一下我们标记的txt文件 举个例子</p><p>这是我们需要的标记格式</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">0 0.5 0.5 0.5 0.5<br></code></pre></td></tr></table></figure><p>这是错误的标注格式 <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">0 0.5 0.5 0.5 0.5<br><br></code></pre></td></tr></table></figure></p><p>问题就出在了最后一行的<code>\n</code>上，我们删除最后一行就可以了。我用chatGPT写了一个函数来做这件事 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 去除txt文件中的空行</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">remove_empty_lines</span>(<span class="hljs-params">file_path</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        lines = f.readlines()<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(line)&gt;<span class="hljs-number">3</span>:<br>                f.write(line)<br></code></pre></td></tr></table></figure></p><h2 id="assertionerror-no-results.txt-files-found-in-contentyolov5-facerunstrainexp-nothing-to-plot.">AssertionError: No results.txt files found in /content/yolov5-face/runs/train/exp, nothing to plot.</h2><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs stata">Traceback (most recent call last):<br><span class="hljs-keyword">File</span> <span class="hljs-string">&quot;train.py&quot;</span>, <span class="hljs-keyword">line</span> 513, <span class="hljs-keyword">in</span><br>train(hyp, opt, device, tb_writer, wandb)<br><span class="hljs-keyword">File</span> <span class="hljs-string">&quot;train.py&quot;</span>, <span class="hljs-keyword">line</span> 400, <span class="hljs-keyword">in</span> train<br>plot_results(save_dir=save_dir) # <span class="hljs-keyword">save</span> <span class="hljs-keyword">as</span> results.png<br><span class="hljs-keyword">File</span> <span class="hljs-string">&quot;/content/yolov5-face/utils/plots.py&quot;</span>, <span class="hljs-keyword">line</span> 393, <span class="hljs-keyword">in</span> plot_results<br><span class="hljs-keyword">assert</span> len(files), &#x27;<span class="hljs-keyword">No</span> results.txt files found <span class="hljs-keyword">in</span> %s, nothing to <span class="hljs-keyword">plot</span>.&#x27; % os.path.abspath(save_dir)<br>AssertionError: <span class="hljs-keyword">No</span> results.txt files found <span class="hljs-keyword">in</span> /content/yolov5-face/runs/train/exp, nothing to <span class="hljs-keyword">plot</span>.<br></code></pre></td></tr></table></figure><p>出现这个问题的原因是此代码块未运行 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Results</span><br>       <span class="hljs-keyword">if</span> ckpt.get(<span class="hljs-string">&#x27;training_results&#x27;</span>) <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>           <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(results_file, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>               file.write(ckpt[<span class="hljs-string">&#x27;training_results&#x27;</span>])  <span class="hljs-comment"># write results.txt</span><br></code></pre></td></tr></table></figure> 如果你只使用单 GPU 并设置 epoch &lt;20，这个块将不起作用。解决方案是设置epoch&gt;20。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;yolov5常见踩坑&quot;&gt;yolov5常见踩坑&lt;/h1&gt;
&lt;h2 id=&quot;not-enough-values-to-unpack-expected-2-got-0&quot;&gt;not enough values to unpack (expected 2, got 0)&lt;/h</summary>
      
    
    
    
    <category term="踩坑" scheme="https://studyinglover.github.io/categories/%E8%B8%A9%E5%9D%91/"/>
    
    
    <category term="机器视觉" scheme="https://studyinglover.github.io/tags/%E6%9C%BA%E5%99%A8%E8%A7%86%E8%A7%89/"/>
    
  </entry>
  
  <entry>
    <title>copliot才是代码开发神器</title>
    <link href="https://studyinglover.github.io/2023/02/04/copliot%E6%89%8D%E6%98%AF%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91%E7%A5%9E%E5%99%A8/"/>
    <id>https://studyinglover.github.io/2023/02/04/copliot%E6%89%8D%E6%98%AF%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91%E7%A5%9E%E5%99%A8/</id>
    <published>2023-02-04T21:45:00.000Z</published>
    <updated>2023-02-07T09:07:55.221Z</updated>
    
    <content type="html"><![CDATA[<h1 id="copliot才是代码开发神器">copliot才是代码开发神器</h1><p>本文使用copilot和chatGPT辅助完成</p><p>copilot是微软的AI代码生成器，可以帮助我们快速完成代码编写(这句copilot简介是copilot写的)。在openai的chatGPT出现后，copilot的风头有所下降，直到刚才…… 几分钟前我在写我的博客<a href="https://studyinglover.com/2023/02/04/ThreeJS%E5%AE%9E%E7%8E%B0%E5%B1%8F%E5%B9%95%E5%9D%90%E6%A0%87%E8%BD%AC3d%E5%9D%90%E6%A0%87/">ThreeJS实现屏幕坐标转3d坐标</a>时，原本的第一段代码是这样的： <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">get3DPosition</span>(<span class="hljs-params">x, y, camera, scene, hyper_z</span>) &#123;<br>        <span class="hljs-keyword">var</span> vector = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Vector3</span>();<br>        <span class="hljs-comment">// calculate mouse position in normalized device coordinates</span><br>        <span class="hljs-comment">// (-1 to +1) for both components</span><br>        vector.<span class="hljs-property">x</span> = (x / <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>) * <span class="hljs-number">2</span> - <span class="hljs-number">1</span>;<br>        vector.<span class="hljs-property">y</span> = - (y / <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>) * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>;<br>        vector.<span class="hljs-property">z</span> = hyper_z;<br><br>        <span class="hljs-comment">// unproject the vector</span><br>        vector.<span class="hljs-title function_">unproject</span>(camera);<br><br>        <span class="hljs-comment">// calculate the ray from the camera to the vector</span><br>        <span class="hljs-keyword">var</span> ray = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Raycaster</span>(camera.<span class="hljs-property">position</span>, vector.<span class="hljs-title function_">sub</span>(camera.<span class="hljs-property">position</span>).<span class="hljs-title function_">normalize</span>());<br><br>        <span class="hljs-comment">// check for intersection with objects in the scene</span><br>        <span class="hljs-keyword">var</span> intersects = ray.<span class="hljs-title function_">intersectObjects</span>(scene.<span class="hljs-property">children</span>);<br>        <span class="hljs-keyword">if</span> (intersects.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> intersects[<span class="hljs-number">0</span>].<span class="hljs-property">point</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure> 正当我写完 &gt; 官方为我们提供了一个接口<code>vector.unproject(camera)</code> 打算粘贴上我的代码时，copilot突然给了我一大段代码提示，并给出了我一段代码</p><p>emmmmmmmmmm,当时的我是有点懵的，我回去看了看当时这段代码的目的，发现这段代码的目的(实不相瞒写到这copilot又给我一段提示(实不相瞒写到这copilot又给我一段提示(......)))先获取点击的坐标点，再获取我点击的3d物体的名称。所以前半部分没问题，真正要改的是后部分。更改后的代码如下： <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">screenToWorld</span>(<span class="hljs-params">screenX, screenY, camera，hyper_z</span>) &#123;<br>    <span class="hljs-keyword">const</span> vector = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Vector3</span>();<br>    vector.<span class="hljs-title function_">set</span>(<br>        (screenX / <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>) * <span class="hljs-number">2</span> - <span class="hljs-number">1</span>,<br>        -(screenY / <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>) * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>,<br>        hyper_z<br>    );<br>    vector.<span class="hljs-title function_">unproject</span>(camera);<br>    vector.<span class="hljs-title function_">applyMatrix4</span>(camera.<span class="hljs-property">matrixWorldInverse</span>);<br>    <span class="hljs-keyword">return</span> vector;<br>&#125;<br></code></pre></td></tr></table></figure></p><p>你以为结束了吗，当我继续往下写我的博客，写道 &gt; 这里的<code>hyper_z</code>网上很多教程认为是写0.5,</p><p>copilot又给我一段代码提示，，这次的提示是这样的 <img src="https://cdn.jsdelivr.net/gh/StudyingLover/anything/20230204214713.png" /> 还好还好，这次代码的目的没搞错，只是整个代码都可能写错了而已……</p><p>经过一番思考，我决定继续按照原先的代码写，因为我已经尝试了代码的效果，勉强可以达到我们的要求。</p><p>最后，我想说的是，copilot真的是一个神器，但是要注意，它只是一个辅助工具，不要完全依赖它，因为它可能会给你一些错误的代码提示，这时候你就要自己去思考了。(这段话还是copilot写的)</p><p>总而言之，Copilot是代码开发领域中高效且创新的工具。它具有易于使用的界面和先进的功能，已被证明是开发人员的游戏规则改变者，并被广泛认为是最终的代码开发工具。无论您是经验丰富的程序员还是刚刚入门，Copilot都提供了您需要的工具，可以比以往更快、更高效地完成工作。(这段话是chatGPT写的)</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;copliot才是代码开发神器&quot;&gt;copliot才是代码开发神器&lt;/h1&gt;
&lt;p&gt;本文使用copilot和chatGPT辅助完成&lt;/p&gt;
&lt;p&gt;copilot是微软的AI代码生成器，可以帮助我们快速完成代码编写(这句copilot简介是copilot写的)。在op</summary>
      
    
    
    
    <category term="工具" scheme="https://studyinglover.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
    <category term="Microsoft" scheme="https://studyinglover.github.io/tags/Microsoft/"/>
    
  </entry>
  
  <entry>
    <title>ThreeJS实现屏幕坐标转3d坐标</title>
    <link href="https://studyinglover.github.io/2023/02/04/ThreeJS%E5%AE%9E%E7%8E%B0%E5%B1%8F%E5%B9%95%E5%9D%90%E6%A0%87%E8%BD%AC3d%E5%9D%90%E6%A0%87/"/>
    <id>https://studyinglover.github.io/2023/02/04/ThreeJS%E5%AE%9E%E7%8E%B0%E5%B1%8F%E5%B9%95%E5%9D%90%E6%A0%87%E8%BD%AC3d%E5%9D%90%E6%A0%87/</id>
    <published>2023-02-04T20:30:00.000Z</published>
    <updated>2023-02-07T09:07:55.221Z</updated>
    
    <content type="html"><![CDATA[<h1 id="threejs实现屏幕坐标转3d坐标">ThreeJS实现屏幕坐标转3d坐标</h1><p>本文使用chatGPT辅助完成</p><p>在虚拟世界中，3D坐标与屏幕坐标之间的转换是一个重要的问题。使用ThreeJS开发3D场景时，经常需要将屏幕坐标转换为3D坐标。在本文中，我们将介绍如何使用ThreeJS实现屏幕坐标转3D坐标的两种方法</p><h2 id="根据相机的投影矩阵和射线拾取">根据相机的投影矩阵和射线拾取</h2><p>在我的笔记<a href="https://studyinglover.com/2022/12/29/%E6%91%84%E5%83%8F%E6%9C%BA%E6%A8%A1%E5%9E%8B/">摄像机模型</a>中详细推导了相机的投影矩阵。</p><p>在ThreeJS中，相机的投影矩阵是一个4x4的矩阵，它将3D坐标转换为屏幕坐标。我们可以使用这个矩阵将屏幕坐标转换为3D坐标。 官方为我们提供了一个接口<code>vector.unproject(camera)</code>,它可以将屏幕坐标转换为3D坐标。但是这个接口只能将屏幕坐标转换为相机坐标系下的3D坐标，如果我们需要将屏幕坐标转换为世界坐标系下的3D坐标，我们需要使用<code>vector.applyMatrix4(camera.matrixWorldInverse)</code>将相机坐标系下的3D坐标转换为世界坐标系下的3D坐标。(这里代码本来不是这么写的，但是copilot给了我好多提示，我就照着他的提示改了改，如果你发现代码有问题，问问chatGPT吧)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">screenToWorld</span>(<span class="hljs-params">screenX, screenY, camera，hyper_z</span>) &#123;<br>    <span class="hljs-keyword">const</span> vector = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Vector3</span>();<br>    vector.<span class="hljs-title function_">set</span>(<br>        (screenX / <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>) * <span class="hljs-number">2</span> - <span class="hljs-number">1</span>,<br>        -(screenY / <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>) * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>,<br>        hyper_z<br>    );<br>    vector.<span class="hljs-title function_">unproject</span>(camera);<br>    vector.<span class="hljs-title function_">applyMatrix4</span>(camera.<span class="hljs-property">matrixWorldInverse</span>);<br>    <span class="hljs-keyword">return</span> vector;<br>&#125;<br></code></pre></td></tr></table></figure><p>这里的<code>hyper_z</code>网上很多教程认为是写0.5,但是我实际试了一下，发现效果很差，就把他改成了一个超参数。后来在一位不能透露姓名的大佬的帮助下，得知这个参数的值应该写成1。我试了下，勉强可以得到预期的效果</p><h2 id="通过深度图采样shader改深度缓冲">通过深度图采样，shader改深度缓冲</h2><p>这种方法是通过深度图采样，shader改深度缓冲，然后再通过深度缓冲得到3D坐标。这种方法的优点是可以得到更精确的3D坐标，但是缺点是需要使用shader，而且需要修改深度缓冲，可能会影响性能。</p><p>感谢chatGPT，我只需要把我需要的内容告诉他，他就会给我写一个完整的代码。 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">convert2Dto3D</span>(<span class="hljs-params">mouseX, mouseY, camera, width, height, scene</span>) &#123;<br>        <span class="hljs-comment">// 构建纹理</span><br>        <span class="hljs-keyword">var</span> depthTarget = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">WebGLRenderTarget</span>(width, height);<br>        depthTarget.<span class="hljs-property">texture</span>.<span class="hljs-property">minFilter</span> = <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">LinearFilter</span>;<br><br>        <span class="hljs-comment">// 渲染深度图</span><br>        renderer.<span class="hljs-title function_">render</span>(scene, camera, depthTarget);<br><br>        <span class="hljs-comment">// 创建着色器</span><br>        <span class="hljs-keyword">var</span> material = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">ShaderMaterial</span>(&#123;<br>            <span class="hljs-attr">uniforms</span>: &#123;<br>                <span class="hljs-attr">mouse</span>: &#123; <span class="hljs-attr">value</span>: <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Vector2</span>(mouseX, mouseY) &#125;,<br>                <span class="hljs-attr">depthMap</span>: &#123; <span class="hljs-attr">value</span>: depthTarget.<span class="hljs-property">texture</span> &#125;,<br>                <span class="hljs-attr">projectionMatrix</span>: &#123; <span class="hljs-attr">value</span>: camera.<span class="hljs-property">projectionMatrix</span> &#125;,<br>                <span class="hljs-attr">viewMatrix</span>: &#123; <span class="hljs-attr">value</span>: camera.<span class="hljs-property">matrixWorldInverse</span> &#125;<br>            &#125;,<br>            <span class="hljs-attr">vertexShader</span>: <span class="hljs-string">`</span><br><span class="hljs-string">                uniform vec2 mouse;</span><br><span class="hljs-string">                uniform mat4 projectionMatrix;</span><br><span class="hljs-string">                uniform mat4 viewMatrix;</span><br><span class="hljs-string">                uniform sampler2D depthMap;</span><br><span class="hljs-string">                varying vec4 pos;</span><br><span class="hljs-string">                void main() &#123;</span><br><span class="hljs-string">                    pos = vec4(position, 1.0);</span><br><span class="hljs-string">                    gl_Position = projectionMatrix * viewMatrix * pos;</span><br><span class="hljs-string">                &#125;</span><br><span class="hljs-string">            `</span>,<br>            <span class="hljs-attr">fragmentShader</span>: <span class="hljs-string">`</span><br><span class="hljs-string">                uniform vec2 mouse;</span><br><span class="hljs-string">                uniform sampler2D depthMap;</span><br><span class="hljs-string">                varying vec4 pos;</span><br><span class="hljs-string">                void main() &#123;</span><br><span class="hljs-string">                    float depth = texture2D(depthMap, mouse).r;</span><br><span class="hljs-string">                    vec4 viewPos = vec4(mouse * 2.0 - 1.0, depth * 2.0 - 1.0, 1.0);</span><br><span class="hljs-string">                    vec4 worldPos = viewMatrix * viewPos;</span><br><span class="hljs-string">                    worldPos /= worldPos.w;</span><br><span class="hljs-string">                    gl_FragColor = vec4(worldPos.xyz, 1.0);</span><br><span class="hljs-string">                &#125;</span><br><span class="hljs-string">            `</span><br>        &#125;);<br><br>        <span class="hljs-comment">// 创建一个平面作为渲染目标</span><br>        <span class="hljs-keyword">var</span> plane = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">PlaneBufferGeometry</span>(width, height);<br>        <span class="hljs-keyword">var</span> mesh = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Mesh</span>(plane, material);<br>        scene.<span class="hljs-title function_">add</span>(mesh);<br><br>        <span class="hljs-comment">// 渲染一次着色器并获取结果</span><br>        renderer.<span class="hljs-title function_">render</span>(scene, camera);<br>        <span class="hljs-keyword">var</span> pixelBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);<br>        renderer.<span class="hljs-title function_">readRenderTargetPixels</span>(depthTarget, mouseX, height - mouseY, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, pixelBuffer);<br>        <span class="hljs-keyword">var</span> worldPos = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Vector3</span>(<br>            (pixelBuffer[<span class="hljs-number">0</span>] / <span class="hljs-number">255</span>) * <span class="hljs-number">2</span> - <span class="hljs-number">1</span>,<br>            (pixelBuffer[<span class="hljs-number">1</span>] / <span class="hljs-number">255</span>) * <span class="hljs-number">2</span> - <span class="hljs-number">1</span>,<br>            (pixelBuffer[<span class="hljs-number">2</span>] / <span class="hljs-number">255</span>) * <span class="hljs-number">2</span> - <span class="hljs-number">1</span><br>        );<br>        worldPos.<span class="hljs-title function_">applyMatrix4</span>(camera.<span class="hljs-property">matrixWorldInverse</span>);<br>        scene.<span class="hljs-title function_">remove</span>(mesh);<br>        <span class="hljs-keyword">return</span> worldPos;<br>    &#125;,<br><br>    <span class="hljs-comment">//获取触摸点的坐标并转换为ThreeJS中的坐标</span><br>    <span class="hljs-attr">touch_crash_detect</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">touch_crash_detect</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;touchmove&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;<br>            <span class="hljs-comment">// screen3D_to_3DCoord(event.touches[0].clientX, event.touches[0].clientY,camera, window.innerWidth, window.innerHeight);</span><br>            <span class="hljs-keyword">let</span> pos = space_pos_convert.<span class="hljs-title function_">get3DPosition</span>(event.<span class="hljs-property">touches</span>[<span class="hljs-number">0</span>].<span class="hljs-property">clientX</span>, event.<span class="hljs-property">touches</span>[<span class="hljs-number">0</span>].<span class="hljs-property">clientY</span>, camera, scene, <span class="hljs-number">1</span>);<br>            <span class="hljs-keyword">if</span> (pos.<span class="hljs-property">y</span> != <span class="hljs-number">0</span>) &#123;<br>                pos.<span class="hljs-property">y</span> = <span class="hljs-number">0</span>;<br>            &#125;<br>            <span class="hljs-keyword">return</span> pos;<br>            <span class="hljs-comment">// playerMesh.position.set(pos.x, pos.y, pos.z);</span><br>        &#125;);<br>    &#125;<br></code></pre></td></tr></table></figure></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;threejs实现屏幕坐标转3d坐标&quot;&gt;ThreeJS实现屏幕坐标转3d坐标&lt;/h1&gt;
&lt;p&gt;本文使用chatGPT辅助完成&lt;/p&gt;
&lt;p&gt;在虚拟世界中，3D坐标与屏幕坐标之间的转换是一个重要的问题。使用ThreeJS开发3D场景时，经常需要将屏幕坐标转换为3D坐</summary>
      
    
    
    
    <category term="工具" scheme="https://studyinglover.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
    <category term="ThreeJS" scheme="https://studyinglover.github.io/tags/ThreeJS/"/>
    
  </entry>
  
  <entry>
    <title>在fluid主题中加入Google广告</title>
    <link href="https://studyinglover.github.io/2023/01/27/%E5%9C%A8fluid%E4%B8%BB%E9%A2%98%E4%B8%AD%E5%8A%A0%E5%85%A5Google%E5%B9%BF%E5%91%8A/"/>
    <id>https://studyinglover.github.io/2023/01/27/%E5%9C%A8fluid%E4%B8%BB%E9%A2%98%E4%B8%AD%E5%8A%A0%E5%85%A5Google%E5%B9%BF%E5%91%8A/</id>
    <published>2023-01-27T10:00:00.000Z</published>
    <updated>2023-02-07T09:07:55.221Z</updated>
    
    <content type="html"><![CDATA[<h1 id="在fluid主题中加入google广告">在fluid主题中加入Google广告</h1><p>在fluid的<a href="https://hexo.fluid-dev.com/posts/fluid-adsense/">官方文档</a>中，提供了在fluid主题中加入Google广告的方法，但是其中提到的参数<code>data-ad-slot</code>并没有说清怎么获取，所以我决定详细写一下如何获取。</p><h2 id="注册google-adsense">注册Google Adsense</h2><p>访问<a href="https://www.google.com/adsense/start/">Google Adsense</a>，注册一个账号，然后点击右侧的广告。 <img src="https://cdn.jsdelivr.net/gh/StudyingLover/anything/20230127100353.png" /></p><h2 id="创建一个广告单元">创建一个广告单元</h2><p>选择上方的按广告单元 <img src="https://cdn.jsdelivr.net/gh/StudyingLover/anything/20230127100502.png" /></p><p>这里我选择了推荐的展示广告 <img src="https://cdn.jsdelivr.net/gh/StudyingLover/anything/20230127100605.png" /></p><p>接着自定义广告单元，自定义广告 <img src="https://cdn.jsdelivr.net/gh/StudyingLover/anything/20230127100808.png" /></p><p>接着就能看到广告代码了，其中就有我们需要的<code>data-ad-client</code>和<code>data-ad-slot</code>参数</p><p>例如，我的代码是这样的红框中的就是我们需要的参数 <img src="https://cdn.jsdelivr.net/gh/StudyingLover/anything/20230127101239.png" /></p><h2 id="嵌入到fluid主题中">嵌入到fluid主题中</h2><p>在博客根目录下找到 scripts 文件夹（不存在就创建一个），进入后任意创建一个 js 文件，比如 <code>inject.js</code>，复制以下内容： <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript">hexo.<span class="hljs-property">extend</span>.<span class="hljs-property">filter</span>.<span class="hljs-title function_">register</span>(<span class="hljs-string">&#x27;theme_inject&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">injects</span>) &#123;<br>injects.<span class="hljs-property">bodyEnd</span>.<span class="hljs-title function_">raw</span>(<span class="hljs-string">&#x27;adsense&#x27;</span>, <span class="hljs-string">&#x27;&lt;script async src=&quot;https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-xxxxxx&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;&#x27;</span>);<br>injects.<span class="hljs-property">head</span>.<span class="hljs-title function_">raw</span>(<span class="hljs-string">&#x27;adsense&#x27;</span>, <span class="hljs-string">&#x27;&lt;style&gt;ins.adsbygoogle[data-ad-status=&quot;unfilled&quot;] &#123; display: none !important; &#125;&lt;/style&gt;&#x27;</span>);<br>injects.<span class="hljs-property">postLeft</span>.<span class="hljs-title function_">raw</span>(<span class="hljs-string">&#x27;adsense&#x27;</span>, <span class="hljs-string">&#x27;&lt;aside class=&quot;sidebar d-none d-xl-block&quot; style=&quot;margin-right:-1rem;z-index:-1&quot;&gt;&lt;ins class=&quot;adsbygoogle&quot; style=&quot;display:flex;justify-content:center;min-width:160px;max-width:300px;width:100%;height:600px;position:sticky;top:2rem&quot; data-ad-client=&quot;ca-pub-xxxxxx&quot; data-ad-slot=&quot;yyyyyy&quot;&gt;&lt;/ins&gt;&lt;script&gt; (adsbygoogle = window.adsbygoogle || []).push(&#123;&#125;); &lt;/script&gt;&lt;/aside&gt;&#x27;</span>);<br>injects.<span class="hljs-property">postCopyright</span>.<span class="hljs-title function_">raw</span>(<span class="hljs-string">&#x27;adsense&#x27;</span>, <span class="hljs-string">&#x27;&lt;div style=&quot;width:100%;display:flex;justify-content:center;margin-bottom:1.5rem&quot;&gt;&lt;ins class=&quot;adsbygoogle&quot; style=&quot;display:flex;justify-content:center;max-width:845px;width:100%;height:90px&quot; data-ad-client=&quot;ca-pub-xxxxxx&quot; data-ad-slot=&quot;yyyyyy&quot;&gt;&lt;/ins&gt;&lt;script&gt; (adsbygoogle = window.adsbygoogle || []).push(&#123;&#125;); &lt;/script&gt;&lt;/div&gt;&#x27;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure> 复制之后，把其中 <code>ca-pub-xxxxxx</code> 和 <code>data-ad-slot="yyyyyy"</code> 换成我们上面获取到的参数即可。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;在fluid主题中加入google广告&quot;&gt;在fluid主题中加入Google广告&lt;/h1&gt;
&lt;p&gt;在fluid的&lt;a href=&quot;https://hexo.fluid-dev.com/posts/fluid-adsense/&quot;&gt;官方文档&lt;/a&gt;中，提供了在flui</summary>
      
    
    
    
    <category term="踩坑" scheme="https://studyinglover.github.io/categories/%E8%B8%A9%E5%9D%91/"/>
    
    
  </entry>
  
  <entry>
    <title>在网页或博客中嵌入ppt</title>
    <link href="https://studyinglover.github.io/2023/01/26/%E5%9C%A8%E7%BD%91%E9%A1%B5%E6%88%96%E5%8D%9A%E5%AE%A2%E4%B8%AD%E5%B5%8C%E5%85%A5ppt/"/>
    <id>https://studyinglover.github.io/2023/01/26/%E5%9C%A8%E7%BD%91%E9%A1%B5%E6%88%96%E5%8D%9A%E5%AE%A2%E4%B8%AD%E5%B5%8C%E5%85%A5ppt/</id>
    <published>2023-01-26T21:00:00.000Z</published>
    <updated>2023-02-07T09:07:55.221Z</updated>
    
    <content type="html"><![CDATA[<p>当我们想要与他人共享ppt时，除了传统的展示方式外，还将其保存到 OneDrive，然后就可以将其嵌入到网页或博客中。</p><p>嵌入ppt的代码<strong>必须</strong>从PowerPoint <strong>网页版</strong> 获取。</p><p>网页版地址为https://office.live.com/start/PowerPoint.aspx</p><p>在网页版打开ppt后，点击右上角的文件按钮 <img src="https://cdn.jsdelivr.net/gh//StudyingLover/anything/20230126203458.png" /></p><p>选择共享，然后点击嵌入 <img src="https://cdn.jsdelivr.net/gh//StudyingLover/anything/20230126203758.png" /></p><p>可以自由调整大小，然后点击复制，插入你想插入位置即可 <img src="https://cdn.jsdelivr.net/gh//StudyingLover/anything/20230126203942.png" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;当我们想要与他人共享ppt时，除了传统的展示方式外，还将其保存到 OneDrive，然后就可以将其嵌入到网页或博客中。&lt;/p&gt;
&lt;p&gt;嵌入ppt的代码&lt;strong&gt;必须&lt;/strong&gt;从PowerPoint &lt;strong&gt;网页版&lt;/strong&gt; 获取。&lt;/p&gt;
&lt;p</summary>
      
    
    
    
    <category term="工具" scheme="https://studyinglover.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
    <category term="Microsoft" scheme="https://studyinglover.github.io/tags/Microsoft/"/>
    
  </entry>
  
  <entry>
    <title>jsdelivr加速Github文件</title>
    <link href="https://studyinglover.github.io/2023/01/20/jsdelivr%E5%8A%A0%E9%80%9FGithub%E6%96%87%E4%BB%B6/"/>
    <id>https://studyinglover.github.io/2023/01/20/jsdelivr%E5%8A%A0%E9%80%9FGithub%E6%96%87%E4%BB%B6/</id>
    <published>2023-01-20T10:00:00.000Z</published>
    <updated>2023-02-07T09:07:55.221Z</updated>
    
    <content type="html"><![CDATA[<p>假设GitHub路径为<code>https://github.com/username/repo-name/path/to/file</code> ,用jsdelivr可以加速或者在html中引用，路径为<code>https://cdn.jsdelivr.net/gh/username/repo-name/path/to/file</code></p><p>这里实现了一个简单的链接转换函数，可以将GitHub路径转换为jsdelivr路径 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_first_occurrence</span>(<span class="hljs-params">string, substring</span>):<br>    <span class="hljs-keyword">return</span> string.find(substring)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gh_path2jsdelivr</span>(<span class="hljs-params">path</span>):<br>    <span class="hljs-keyword">if</span>(find_first_occurrence(path,<span class="hljs-string">&quot;/blob/&quot;</span>) != -<span class="hljs-number">1</span>):<br>        path = path.replace(<span class="hljs-string">&quot;/blob/&quot;</span>, <span class="hljs-string">&quot;/&quot;</span>)<br>    <span class="hljs-keyword">if</span>(find_first_occurrence(path,<span class="hljs-string">&quot;/main/&quot;</span>) != -<span class="hljs-number">1</span>):<br>        path = path.replace(<span class="hljs-string">&quot;/main/&quot;</span>, <span class="hljs-string">&quot;/&quot;</span>)<br>    <span class="hljs-keyword">if</span>(find_first_occurrence(path,<span class="hljs-string">&quot;/master/&quot;</span>) != -<span class="hljs-number">1</span>):<br>        path = path.replace(<span class="hljs-string">&quot;/master/&quot;</span>, <span class="hljs-string">&quot;/&quot;</span>)<br>    <span class="hljs-keyword">return</span> path.replace(<span class="hljs-string">&quot;github.com&quot;</span>, <span class="hljs-string">&quot;cdn.jsdelivr.net/gh&quot;</span>, <span class="hljs-number">1</span>)<br><br><span class="hljs-built_in">print</span>(gh_path2jsdelivr(<span class="hljs-string">&quot;&quot;</span>))<br><br></code></pre></td></tr></table></figure></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;假设GitHub路径为&lt;code&gt;https://github.com/username/repo-name/path/to/file&lt;/code&gt; ,用jsdelivr可以加速或者在html中引用，路径为&lt;code&gt;https://cdn.jsdelivr.net/gh/</summary>
      
    
    
    
    <category term="工具" scheme="https://studyinglover.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
  </entry>
  
  <entry>
    <title>ThreeJS导入失败</title>
    <link href="https://studyinglover.github.io/2023/01/13/ThreeJS%E5%AF%BC%E5%85%A5%E5%A4%B1%E8%B4%A5/"/>
    <id>https://studyinglover.github.io/2023/01/13/ThreeJS%E5%AF%BC%E5%85%A5%E5%A4%B1%E8%B4%A5/</id>
    <published>2023-01-13T10:00:00.000Z</published>
    <updated>2023-02-07T09:07:55.221Z</updated>
    
    <content type="html"><![CDATA[<h2 id="问题描述">问题描述</h2><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-index.html </span><br><span class="hljs-deletion">-src.js</span><br><span class="hljs-deletion">-node_modules</span><br> -three<br>  -...<br></code></pre></td></tr></table></figure><p>在<code>src.js</code> 中用如下方式导入ThreeJS <figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clean"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> THREE <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;three&#x27;</span>;<br></code></pre></td></tr></table></figure> <code>index.html</code> body如下 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;module&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/src/day01_a.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure> 出现报错 <figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Uncaught TypeError: Failed <span class="hljs-built_in">to</span> <span class="hljs-built_in">resolve</span> module specifier <span class="hljs-string">&quot;three&quot;</span>. Relative references must <span class="hljs-built_in">start</span> <span class="hljs-keyword">with</span> either <span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-string">&quot;./&quot;</span>, <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;../&quot;</span>.<br></code></pre></td></tr></table></figure> <img src="https://cdn.jsdelivr.net/gh/StudyingLover/anything/20230103172514.png" alt="image.png" /> ## 解决方案 stackoverflow给出了解决方案https://stackoverflow.com/questions/65697410/not-using-node-js-uncaught-typeerror-failed-to-resolve-module-specifier-thre</p><figure><img src="https://cdn.jsdelivr.net/gh/StudyingLover/anything/20230103172625.png" alt="" /><figcaption>image.png</figcaption></figure><p>删除<code>src.js</code>的导入，将<code>index.html</code> body改为 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/node_modules/three/build/three.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;module&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/src/day01_a.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;问题描述&quot;&gt;问题描述&lt;/h2&gt;
&lt;figure class=&quot;highlight diff&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;</summary>
      
    
    
    
    <category term="踩坑" scheme="https://studyinglover.github.io/categories/%E8%B8%A9%E5%9D%91/"/>
    
    
    <category term="ThreeJS" scheme="https://studyinglover.github.io/tags/ThreeJS/"/>
    
  </entry>
  
  <entry>
    <title>摄像机模型</title>
    <link href="https://studyinglover.github.io/2022/12/29/%E6%91%84%E5%83%8F%E6%9C%BA%E6%A8%A1%E5%9E%8B/"/>
    <id>https://studyinglover.github.io/2022/12/29/%E6%91%84%E5%83%8F%E6%9C%BA%E6%A8%A1%E5%9E%8B/</id>
    <published>2022-12-29T21:47:00.000Z</published>
    <updated>2023-02-07T09:07:55.221Z</updated>
    
    <content type="html"><![CDATA[<h1 id="摄像机模型">摄像机模型</h1><p>本文是鲁鹏老师机器视觉课程的笔记</p><h2 id="针孔模型与透镜">针孔模型与透镜</h2><figure><img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222201922.png" alt="" /><figcaption>image.png</figcaption></figure><figure><img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222201951.png" alt="" /><figcaption>image.png</figcaption></figure><p>虚拟像平面是倒着的</p><figure><img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222202148.png" alt="" /><figcaption>image.png</figcaption></figure><figure><img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222202224.png" alt="" /><figcaption>image.png</figcaption></figure><p><span class="math inline">\(\dfrac{y&#39;}{f}=\dfrac{y}{z}\quad\implies y&#39;=f\dfrac{y}{z}\)</span></p><p><span class="math inline">\(\dfrac{x&#39;}{f}=\dfrac{x}{z}\quad\implies x&#39;=f\dfrac{x}{z}\)</span> <span class="math inline">\(P=\begin{bmatrix}x\\ y\\ z\end{bmatrix}\to P&#39;=\begin{bmatrix}x&#39;\\ y&#39;\end{bmatrix}\quad\quad\)</span></p><p><span class="math inline">\(\begin{cases}x&#39;=f\dfrac{x}{Z}\\ y&#39;=f\dfrac{y}{Z}\end{cases}\)</span></p><h3 id="光圈尺寸">光圈尺寸</h3><p>光圈偏大会导致场景模糊</p><p>光圈偏小会场景清晰，但偏暗 <img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222203219.png" alt="image.png" /></p><p><strong>增加透镜</strong> - 透镜将多条光线聚焦到胶片上，增加了照片的亮度： - 所有平行于光轴的光线都会会聚到焦点，焦点到透镜中心的距离称为焦距 - 穿过中心的光线的方向不发生改变</p><p><img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222203452.png" alt="image.png" /> 根据折射定律： <span class="math inline">\(f=\frac{ {R} }{ {2}({n}-1)}\)</span> ,<span class="math inline">\(R\)</span> 是透镜球面半径，<span class="math inline">\(n\)</span>是透镜折射系数</p><p><span class="math inline">\(z&#39;=f+z_0\quad\begin{cases}x&#39;=z&#39;\dfrac{x}{z}\\ y&#39;=z&#39;\dfrac{y}{z}\end{cases}\)</span></p><p>要是透镜不合适，则会发生失焦 <img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222203756.png" alt="image.png" /></p><p>透镜将光线聚焦到胶片上 - 物体“聚焦”有特定距离 - 景深</p><h3 id="径向畸变">径向畸变</h3><p>图像中所成的像发生形变</p><p>径向畸变:图像像素点以畸变中心为中心点,沿着径向产生的位置偏差,从而导致</p><figure><img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222204142.png" alt="" /><figcaption>image.png</figcaption></figure><p>枕形畸变：畸变像点相对于理想像点沿径向向外偏移,远离中心 桶形畸变：畸变像点相对于理想点沿径向向中心靠拢</p><h2 id="摄像机几何">摄像机几何</h2><h3 id="齐次坐标">齐次坐标</h3><p><span class="math inline">\(E\to H\)</span> 图像点的齐次坐标<span class="math inline">\(\text{}(x,y)\Rightarrow\left[\begin{array}{c}x\\ y\\ 1\end{array}\right]\)</span></p><p>空间点的齐次坐标<span class="math inline">\((x,y,z)\Rightarrow\left[\begin{array}{c}x\\ y\\ z\\ 1\end{array}\right]\)</span></p><p><span class="math inline">\(H \to E\)</span> <span class="math inline">\(\left[\begin{array}{c}x\\ y\\ w\end{array}\right]\Rightarrow\left(x/w,y/w\right)\)</span></p><p><span class="math inline">\(\left[\begin{array}{c}x\\ y\\ z\\ w\end{array}\right]\Rightarrow\left(x/w,y/w,z/w\right)\)</span></p><p><span class="math inline">\(H \to E\)</span> 的转变不是唯一的，但<span class="math inline">\(E \to H\)</span> 的转变是唯一的</p><h3 id="像素坐标系">像素坐标系</h3><p>建立像平面到像素平面关系</p><ol type="1"><li>偏置</li></ol><figure><img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222204440.png" alt="" /><figcaption>image.png</figcaption></figure><figure><img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222204450.png" alt="" /><figcaption>image.png</figcaption></figure><p><span class="math inline">\((x,y,z)\to(f\dfrac{x}{z}+c_x,f\dfrac{y}{z}+c_y)\)</span></p><ol start="2" type="1"><li>单位变换 <span class="math inline">\((x,y,z)\to({fk}\frac{x}{z}+c_x,{fl}\frac{y}{z}+c_y)\)</span> 单位：k.l：pixel/m , f:m k表示竖直方向上多少米表示一个像素，l表示水平方向上多少米表示一个像素</li></ol><p>记<span class="math inline">\(fk\)</span>为<span class="math inline">\(\alpha\)</span> ,<span class="math inline">\(fl\)</span>为<span class="math inline">\(\beta\)</span> <span class="math inline">\(P=(x,y,z)\rightarrow P^{\prime}=\left(\alpha{\frac{x}{z} }+c_{x},\beta{\frac{y}{z} }+c_{y}\right)\)</span> ，这里的<span class="math inline">\(c_x,c_y\)</span>是像素上的偏置</p><p><span class="math inline">\(P=(x,y,z)\rightarrow P^{\prime}=\left(\alpha{\frac{x}{z} }+c_{x},\beta{\frac{y}{z} }+c_{y}\right)\)</span>是非线性变换</p><p>在齐次坐标系下 <span class="math inline">\(P_h&#39;=\begin{bmatrix}\alpha x+c_x z\\ \beta y+c_yz\\ z\end{bmatrix}=\begin{bmatrix}\alpha&amp;0&amp;c_x&amp;0\\ 0&amp;\beta&amp;c_y&amp;0\\ 0&amp;0&amp;1&amp;0\end{bmatrix}\begin{bmatrix}x\\y\\z\\1\end{bmatrix}\)</span></p><p><span class="math inline">\(P&#39;_h\to P&#39;=(\alpha\dfrac{x}{z}+c_x,\beta\dfrac{y}{z}+c_y)\)</span></p><p><span class="math inline">\(P&#39;_h\)</span>是齐次，<span class="math inline">\(P&#39;\)</span> 是欧式</p><h3 id="摄像机的投影矩阵">摄像机的投影矩阵</h3><figure><img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222210401.png" alt="" /><figcaption>image.png</figcaption></figure><p><span class="math inline">\(P&#39;=\begin{bmatrix}\alpha&amp;0&amp;c_x&amp;0\\ 0&amp;\beta&amp;c_y&amp;0\\ 0&amp;0&amp;1&amp;0\end{bmatrix}\begin{bmatrix}x\\ y\\ z\\ 1\end{bmatrix}=MP\)</span></p><p>其中<span class="math inline">\(M=\begin{bmatrix}\alpha&amp;-\alpha\cot\theta&amp;c_x&amp;0\\ 0&amp;\dfrac{\beta}{sin\theta}&amp;c_y&amp;0\\ 0&amp;0&amp;1&amp;0\end{bmatrix}\)</span></p><p>此时<span class="math inline">\(P\)</span>和<span class="math inline">\(P&#39;\)</span> 是线性表示 <span class="math inline">\(P&#39;\)</span>是<span class="math inline">\(3*1\)</span>矩阵，<span class="math inline">\(P\)</span> 是<span class="math inline">\(4*1\)</span>矩阵</p><h3 id="摄像机偏斜">摄像机偏斜</h3><p><img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222210931.png" alt="image.png" /> <span class="math inline">\(P&#39;=\begin{bmatrix}\alpha&amp;-\alpha\cot\theta&amp;c_x&amp;0\\ 0&amp;\frac{\beta}{sin\theta}&amp;c_y&amp;0\\ 0&amp;0&amp;1&amp;0\end{bmatrix}\begin{bmatrix}x\\ y\\ z\\ 1\end{bmatrix}\)</span></p><h3 id="摄像机坐标系下的摄像机模型">摄像机坐标系下的摄像机模型</h3><p><span class="math inline">\(P&#39;=\begin{bmatrix}\alpha&amp;-\alpha\cot\theta&amp;c_x&amp;0\\ 0&amp;\frac{\beta}{sin\theta}&amp;c_y&amp;0\\ 0&amp;0&amp;1&amp;0\end{bmatrix}\begin{bmatrix}x\\ y\\ z\\ 1\end{bmatrix}=MP\)</span></p><p><span class="math inline">\(M=\begin{bmatrix}\alpha&amp;-\alpha\cot\theta&amp;c_x&amp;0\\ 0&amp;\frac{\beta}{sin\theta}&amp;c_y&amp;0\\ 0&amp;0&amp;1&amp;0\end{bmatrix}\)</span>被称为投影矩阵，</p><p><span class="math inline">\(K=\begin{bmatrix}\alpha&amp;-\alpha\cot\theta&amp;c_x\\ 0&amp;\frac{\beta}{sin\theta}&amp;c_y\\ 0&amp;0&amp;1\end{bmatrix}\)</span> 被称为摄像机内参数矩阵，内参数矩阵决定了摄像机坐标系下空间点到图像点的映射</p><p>摄像机内参数为<span class="math inline">\(\alpha,\beta,c_x,c_y,\theta\)</span>，K有五个自由度</p><h3 id="规范化投影变换">规范化投影变换</h3><p><span class="math inline">\(P&#39;=\begin{bmatrix}x\\ y\\ z\end{bmatrix}=\begin{bmatrix}1&amp;0&amp;0&amp;0\\ 0&amp;1&amp;0&amp;0\\ 0&amp;0&amp;1&amp;0\end{bmatrix}\begin{bmatrix}x\\ y\\ z\\ 1\end{bmatrix}\)</span></p><p>已知摄像机矩阵<span class="math inline">\(M\)</span> , <span class="math inline">\(P&#39;=I(MP)\)</span>,<span class="math inline">\(I=\begin{bmatrix}1&amp;0&amp;0\\ 0&amp;1&amp;0\\ 0&amp;0&amp;1\end{bmatrix}\)</span></p><p><span class="math inline">\(\begin{array}{c}\Re^4\xrightarrow{H}\Re^3\\ \boldsymbol{P&#39;}=M\boldsymbol{P}\end{array}\)</span></p><p><span class="math inline">\(P\)</span> 的欧式坐标<span class="math inline">\(\left[\begin{array}{c}{ {\frac{x}{z} }}\\ { {\frac{y}{z} }}\\ \end{array}\right]\)</span></p><h3 id="世界坐标系">世界坐标系</h3><figure><img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222212628.png" alt="" /><figcaption>image.png</figcaption></figure><p><span class="math inline">\(O_w\)</span> 为世界坐标系 <span class="math inline">\(O\)</span>摄像机坐标系,<span class="math inline">\(C&#39;\)</span>像平面坐标系</p><p>齐次坐标系<span class="math inline">\(P=\left[\begin{matrix}{R}&amp;{T}\\ {0}&amp;{1}\\ \end{matrix}\right]\boldsymbol{P}_{w}\)</span> , <span class="math inline">\(\begin{bmatrix}x_w\\ y_w\\ z_w\\ 1\end{bmatrix}\)</span> ，即摄像机坐标系是世界坐标系经过一个旋转，再经过一个平移得到的</p><p>世界坐标系下<span class="math inline">\(P_w=R^T(P-T)\)</span></p><p>从世界坐标系到像素坐标系<span class="math inline">\(P&#39;=K[I\quad0]P=K[I\quad0]\begin{bmatrix}R&amp;T\\ 0&amp;1\end{bmatrix}P_w=K[R\quad T]P_w=MP_w=\left[{\begin{matrix}{m_{1} }\\ {m_{2} }\\ {m_{3} }\end{matrix} }\right]P_{\mathrm{w} }\)</span> <span class="math inline">\(\begin{bmatrix}R &amp; T\end{bmatrix}\)</span>称为外参数矩阵，K是内参数，这就是完整的摄像机模型</p><p><span class="math inline">\(M\)</span> 称为投影矩阵，有11个自由度</p><p>摄像机O点坐标为<span class="math inline">\(-R^TT\)</span></p><p><span class="math inline">\(\left[{\begin{matrix}{m_{1} }\\ {m_{2} }\\ {m_{3} }\end{matrix} }\right]P_{\mathrm{w} }\)</span> 是转换为欧式坐标系的写法，<span class="math inline">\(m_i\)</span> 是一个<span class="math inline">\(1*4\)</span> 的矩阵</p><figure><img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222215030.png" alt="" /><figcaption>image.png</figcaption></figure><h3 id="投影变化的性质">投影变化的性质</h3><ol type="1"><li>点投影为点</li><li>线投影为线</li><li>近大远小</li><li>角度不再保持</li><li>平行线相交</li></ol><h2 id="其他摄像机模型">其他摄像机模型</h2><h3 id="透视投影摄像机">透视投影摄像机</h3><p>^b240bc</p><figure><img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222220419.png" alt="" /><figcaption>image.png</figcaption></figure><p><span class="math inline">\(P&#39;_{3\times1}=MP_W=K_{3\times3}[R\quad T]_{3\times4}P_{W4\times1}=\begin{bmatrix}m_1\\ m_2\\ m_3\end{bmatrix}P_w=\begin{bmatrix}m_1P_w\\ m_2P_w\\ m_3P_w\end{bmatrix}\stackrel{E}{\longrightarrow}(\dfrac{m_1P_w}{m_3P_w},\dfrac{m_2P_w}{m_3P_w})\quad,M=\begin{bmatrix}m_1\\ m_2\\ m_3\end{bmatrix}\)</span><br />### 弱透视投影摄像机</p><figure><img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222220925.png" alt="" /><figcaption>image.png</figcaption></figure><p><span class="math inline">\(\begin{cases}x&#39;=\dfrac{f&#39;}{z}x\\ y&#39;=\dfrac{f&#39;}{z}y\end{cases}\rightarrow\begin{cases}x&#39;=\dfrac{f&#39;}{z_0}x\\ y&#39;=\dfrac{f}{z_0}y\end{cases}\)</span></p><p>从投影（透视）到弱透视<span class="math inline">\(M=K[RT]=\begin{bmatrix}A_{2\times3}&amp;b_{2\times1}\\ v_{1\times2}&amp;1\end{bmatrix}\quad\to M=\begin{bmatrix}A&amp;b\\ 0&amp;1\end{bmatrix}\quad\)</span></p><p><span class="math inline">\(P&#39;=MP_w=\begin{bmatrix}m_1\\ m_2\\ m_3\end{bmatrix}P_w=\begin{bmatrix}m_1P_w\\ m_2P_w\\ 1\end{bmatrix}\stackrel{E}{\longrightarrow}\left(m_{1}P_{W},m_{2}P_{w}\right)\)</span> ,<span class="math inline">\(m_1,m_2\)</span> 为放大率</p><p><span class="math inline">\(M=\begin{bmatrix}A&amp;b\\ v&amp;1\end{bmatrix}=\begin{bmatrix}m_1\\ m_2\\ m_3\end{bmatrix}=\begin{bmatrix}&amp;m_1&amp;\\ &amp;m_2&amp;\\ 0&amp;0&amp;0&amp;1\end{bmatrix}\)</span></p><h3 id="正交投影摄像机">正交投影摄像机</h3><figure><img src="https://raw.githubusercontent.com/StudyingLover/anything/main/20221222222006.png" alt="" /><figcaption>image.png</figcaption></figure><p><span class="math inline">\(\begin{cases}x&#39;=\dfrac{f&#39;}{z}x\\ y&#39;=\dfrac{f&#39;}{z}y\end{cases}\quad\to\quad\begin{cases}x&#39;=x\\ y&#39;=y\end{cases}\)</span></p><h3 id="各种摄像机模型的应用场合">各种摄像机模型的应用场合</h3><ul><li>正交投影<ul><li>更多应用在建筑设计(AUTOCAD)或者工业设计行业</li></ul></li><li>弱透视投影在数学方面更简单<ul><li>当物体较小且较远时准确，常用于图像识别任务</li></ul></li><li>透视投影对于3D到2D映射的建模更为准确<ul><li>用于运动恢复结构或SLAM</li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;摄像机模型&quot;&gt;摄像机模型&lt;/h1&gt;
&lt;p&gt;本文是鲁鹏老师机器视觉课程的笔记&lt;/p&gt;
&lt;h2 id=&quot;针孔模型与透镜&quot;&gt;针孔模型与透镜&lt;/h2&gt;
&lt;figure&gt;
&lt;img src=&quot;https://raw.githubusercontent.com/Studyin</summary>
      
    
    
    
    <category term="工具" scheme="https://studyinglover.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
    <category term="机器视觉" scheme="https://studyinglover.github.io/tags/%E6%9C%BA%E5%99%A8%E8%A7%86%E8%A7%89/"/>
    
  </entry>
  
</feed>
